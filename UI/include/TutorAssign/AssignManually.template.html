<?php
if (isset($AssignManuallyNotificationElements)) {
    foreach ($AssignManuallyNotificationElements as $notificationElement) {
        print $notificationElement;
    }
}
?>

<input type="hidden" name="action" value="AssignManually">
<div class="content-element">
    <div class="content-header">
        <div class="content-title left uppercase">Manuelle Zuweisung</div>
    </div>
        
    <div class="content-body-wrapper">  
    
    <div>
    <?php 
        $sortTypes = array('lastName' => 'Nachname','firstName' => 'Vorname','userName' => 'Nutzername');
    ?>
    <label class="left label bold new-line" for="sortUsers">Sortierung:</label> 
    <select class="form-field left text-input" name="sortUsers" id="sortUsers">
            <?php
                foreach ($sortTypes as $key => $value) {
                    echo "<option value='{$key}'".(isset($sortUsers) &&  $sortUsers==$key ? ' selected="selected"' : '').">{$value}</option>";
                }
            ?>
    </select>
    <button name="actionSortUsers" value="" class="left text-button-simple body-option-color">>></button>
    </div>
    
        <div class="content-body left">
        
            <?php $statusList = CourseStatus::getStatusDefinition();
                foreach ($tutorAssignments as $tutorAssignment): ?>
                <div class="tutor-assign-element left">
                    <div class="tutor-assign-element-title">
                        <?php
                        $tutorId = isset($tutorAssignment['tutor']['id']) ? $tutorAssignment['tutor']['id'] : null;

                        if (isset($tutorAssignment['tutor']['id'])){
                            print '<input type="radio" name="tutorID" value="';
                            print $tutorId . '" for="';
                            print $tutorId . '" />';
                        }

                        print '<label for="';
                        print $tutorId . '" class="tutor-name">';

                        if ($tutorAssignment['tutor']['userName'] != "unassigned") {
                            if (!isset($tutorAssignment['tutor']['id'])){
                                echo "unbekannter Kontrolleur";
                            } else {
                                print isset($tutorAssignment['tutor']['firstName']) ? $tutorAssignment['tutor']['firstName'].' ' : '';
                                print isset($tutorAssignment['tutor']['lastName']) ? $tutorAssignment['tutor']['lastName'].' ': '';
                                $status = isset($tutorAssignment['tutor']['courses'][0]['status']) ? $statusList[$tutorAssignment['tutor']['courses'][0]['status']] : '';
                                echo isset($tutorAssignment['tutor']['userName']) ? '('.$tutorAssignment['tutor']['userName'].','.$status.')' : '';
                            }
                            print " (" . count($tutorAssignment['submissions']) . ")";
                        } else {
                            print "Unzugeordnet ";
                            print "(" . count($tutorAssignment['submissions']) . ")";
                        }

                        print '</label>';
                        ?>
                    </div>
                    <div class="form-field checkbox-container">
                        <?php 
                        foreach ($tutorAssignment['submissions'] as $submission):

                            print '<input type="checkbox" name="';
                            print $submission['submissionId'];
                            print '" value="';
                            print $submission['submissionId'] . '"/>';
                            $name = (isset($submission['user']['firstName']) && isset($submission['user']['lastName'])) ? $submission['user']['firstName'].' '.$submission['user']['lastName'].',': '';
                            print $submission['submissionId'].(isset($submission['user']['userName']) ? ' ('.$name.$submission['user']['userName'].')' : '');
                            print '<br />';
                        endforeach;
                        ?>
                    </div>
                </div>
            <?php endforeach; ?>
        </div>
    </div> <!-- end: content-body-wrapper -->
</div> <!-- end: content-element -->
